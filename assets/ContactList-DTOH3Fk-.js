import{d as M,l as c,w as x,m as B,o as n,c as r,a as u,e as d,t as f,n as A,g as b,b as s,u as l,p,i as w,h as $,q as I,s as j,f as L,v as T,_ as z}from"./index-DkiEf_42.js";import{a as _}from"./axios-CCb-kr4I.js";import{s as G}from"./index-CRviYiyA.js";import{c as O,a as C,V as q}from"./index.esm-dMrDDtoG.js";import"./_commonjsHelpers-BosuxZz1.js";const Z={key:0},H={key:1},J={class:"flex items-center gap-4 mb-4"},K={key:0,class:"error"},Q={class:"flex items-center gap-4 mb-4"},R={key:0,class:"error"},W={class:"flex items-center gap-4 mb-4"},X={key:0,class:"error"},Y={class:"flex items-center gap-4 mb-4"},P={key:0,class:"error"},ee={class:"flex justify-content-center gap-3"},ae={key:3,class:"success-message"},te=M({__name:"ContactList",setup(le){const m=c([]),V=c(!0),v=c(null),y=c(!1),t=c(null),g=c(null),o=c({name:"",email:"",subject:"",message:""}),h=O().shape({name:C().min("2").required("Name is required").matches(/^[A-Za-z\s]+$/,"Name can only contain letters and spaces"),email:C().email("Invalid email format").required("Email is required"),subject:C().required("Subject is required"),message:C().required("Message is required")}),k=async a=>{try{t.value&&(await h.validateAt(a,t.value),o.value[a]="")}catch(e){e instanceof q&&(o.value[a]=e.message)}},D=async()=>{try{return Object.keys(o.value).forEach(a=>o.value[a]=""),t.value?(await h.validate(t.value,{abortEarly:!1}),!0):!1}catch(a){return a instanceof q&&a.inner.forEach(e=>{o.value[e.path]=e.message}),!1}};x(()=>{var a;return(a=t.value)==null?void 0:a.name},()=>k("name")),x(()=>{var a;return(a=t.value)==null?void 0:a.email},()=>k("email")),x(()=>{var a;return(a=t.value)==null?void 0:a.subject},()=>k("subject")),x(()=>{var a;return(a=t.value)==null?void 0:a.message},()=>k("message")),B(async()=>{try{const a=await _.get("/api/contacts");m.value=a.data.result}catch{v.value="Failed to load contacts."}finally{V.value=!1}});const N=a=>{t.value={...a},y.value=!0},E=()=>{y.value=!1,t.value=null,g.value=null},S=async()=>{if(t.value&&await D())try{await _.put(`/api/contacts/${t.value.id}`,t.value),m.value=m.value.map(e=>e.id===t.value.id?t.value:e),g.value="Contact updated successfully!"}catch{v.value="Failed to update contact."}finally{E()}},U=async a=>{try{await _.delete(`/api/contacts/${a}`),m.value=m.value.filter(e=>e.id!==a)}catch{v.value="Failed to delete contact."}};return(a,e)=>(n(),r("div",null,[e[12]||(e[12]=u("h2",null,"Contact Data",-1)),V.value?(n(),r("div",Z,"Loading...")):d("",!0),v.value?(n(),r("div",H,f(v.value),1)):d("",!0),!V.value&&!v.value?(n(),A(l(I),{key:2,value:m.value,showGridlines:"",tableStyle:"min-width: 50rem"},{default:b(()=>[s(l(p),{field:"id",header:"ID"}),s(l(p),{field:"name",header:"Name"}),s(l(p),{field:"email",header:"Email"}),s(l(p),{field:"subject",header:"Subject"}),s(l(p),{field:"message",header:"Message"}),s(l(p),{header:"Action"},{body:b(i=>[s(l(w),{onClick:F=>N(i.data),class:"mr-3"},{default:b(()=>e[5]||(e[5]=[$("Edit")])),_:2},1032,["onClick"]),s(l(w),{onClick:F=>U(i.data.id)},{default:b(()=>e[6]||(e[6]=[$("Delete")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["value"])):d("",!0),s(l(G),{visible:y.value,"onUpdate:visible":e[4]||(e[4]=i=>y.value=i),header:"Edit Contact",style:{width:"25rem"}},{default:b(()=>[e[11]||(e[11]=u("span",{class:"text-surface-500 dark:text-surface-400 block mb-4"},"Update contact information.",-1)),u("div",J,[e[7]||(e[7]=u("label",{for:"name",class:"font-semibold w-24"},"Name",-1)),s(l(j),{id:"name",modelValue:t.value.name,"onUpdate:modelValue":e[0]||(e[0]=i=>t.value.name=i),class:"flex-auto ml-2",autocomplete:"off"},null,8,["modelValue"]),o.value.name?(n(),r("div",K,f(o.value.name),1)):d("",!0)]),u("div",Q,[e[8]||(e[8]=u("label",{for:"email",class:"font-semibold w-24"},"Email",-1)),s(l(j),{id:"email",modelValue:t.value.email,"onUpdate:modelValue":e[1]||(e[1]=i=>t.value.email=i),class:"flex-auto ml-2",autocomplete:"off"},null,8,["modelValue"]),o.value.email?(n(),r("div",R,f(o.value.email),1)):d("",!0)]),u("div",W,[e[9]||(e[9]=u("label",{for:"subject",class:"font-semibold w-24"},"Subject",-1)),s(l(j),{id:"subject",modelValue:t.value.subject,"onUpdate:modelValue":e[2]||(e[2]=i=>t.value.subject=i),class:"flex-auto ml-2",autocomplete:"off"},null,8,["modelValue"]),o.value.subject?(n(),r("div",X,f(o.value.subject),1)):d("",!0)]),u("div",Y,[e[10]||(e[10]=u("label",{for:"message",class:"font-semibold w-24"},"Message",-1)),L(u("textarea",{id:"message","onUpdate:modelValue":e[3]||(e[3]=i=>t.value.message=i),class:"flex-auto"},null,512),[[T,t.value.message]]),o.value.message?(n(),r("div",P,f(o.value.message),1)):d("",!0)]),u("div",ee,[s(l(w),{type:"button",label:"Cancel",severity:"secondary",onClick:E}),s(l(w),{type:"button",label:"Save",onClick:S})])]),_:1},8,["visible"]),g.value?(n(),r("div",ae,f(g.value),1)):d("",!0)]))}}),re=z(te,[["__scopeId","data-v-8fe37043"]]);export{re as default};
