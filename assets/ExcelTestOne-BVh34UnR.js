import{r as I,u as O}from"./xlsx-DG2X6oDA.js";import{_ as y,l as d,m as E,c as M,b as k,a as S,J as D,o as B}from"./index-DkiEf_42.js";const V={class:"canvas-container"},C={__name:"ExcelTestOne",setup(U){const i=d(null),o=d([]),c=d(""),r=t=>{const e=i.value.getContext("2d");e.clearRect(0,0,i.value.width,i.value.height);const l=new Image;l.src="/static-image.jpg",l.onload=()=>{e.drawImage(l,0,0,i.value.width,i.value.height),t&&(e.font="18px Arial",e.fillStyle="black",e.fillText(t.membership_no,200,745),e.fillText("Nepali Name:",70,520),e.fillText(t.nepali_name,190,520),e.fillText("Name:",430,520),e.fillText(t.name,500,520),e.fillText("Mobile No:",70,550),e.fillText(t.mobile_no,190,550),e.fillText("Email:",430,550),e.fillText(t.email,500,550),e.fillText("Gender:",70,580),e.fillText(t.gender,190,580),e.fillText("Post:",430,580),e.fillText(t.post,500,580),e.fillText("Municipality:",70,610),e.fillText(t.municipality,190,610),e.fillText("District:",430,610),e.fillText(t.district,500,610),e.fillText("Ward No:",70,640),e.fillText(t.ward_no,190,640),e.fillText("Saccos Union:",70,670),e.fillText(t.saccos_union,190,670))}},x=()=>{const t=c.value.trim(),e=o.value.find(l=>String(l.membership_no)===t);e?r(e):i.value.getContext("2d").clearRect(0,0,i.value.width,i.value.height)};return E(()=>{fetch("/AgmFormData.xlsx").then(t=>t.arrayBuffer()).then(t=>{const e=I(t,{type:"array"}),l=e.Sheets[e.SheetNames[0]],s=O.sheet_to_json(l,{header:1}),a=s[0],f=a.indexOf("Name"),m=a.indexOf("Nepali Name"),p=a.indexOf("Gender"),u=a.indexOf("Saccos Union"),_=a.indexOf("Post"),h=a.indexOf("Email"),T=a.indexOf("District"),v=a.indexOf("Municipality"),N=a.indexOf("Ward No"),b=a.indexOf("Mobile No"),g=a.indexOf("Membership No");o.value=s.slice(1).map(n=>({name:n[f]||"",nepali_name:n[m]||"",gender:n[p]||"",saccos_union:n[u]||"",post:n[_]||"",email:n[h]||"",district:n[T]||"",municipality:n[v]||"",ward_no:n[N]||"",mobile_no:n[b]||"",membership_no:n[g]||""})).filter(n=>n.name&&n.nepali_name&&n.gender&&n.saccos_union&&n.post&&n.email&&n.district&&n.municipality&&n.ward_no&&n.mobile_no),console.log(o.value)}).catch(t=>console.error("Error loading the Excel file:",t))}),(t,e)=>{const l=D("InputText");return B(),M("div",V,[k(l,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=s=>c.value=s),placeholder:"Enter Membership Number",class:"input-field",onInput:x},null,8,["modelValue"]),S("canvas",{ref_key:"canvas",ref:i,class:"canvas",width:"800",height:"1000"},null,512)])}}},F=y(C,[["__scopeId","data-v-2b2ea367"]]);export{F as default};
