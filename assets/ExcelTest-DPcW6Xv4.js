import{r as h,u as _}from"./xlsx-DG2X6oDA.js";import{_ as v,l as d,m as g,c as T,a as I,b as C,J as k,o as y}from"./index-DkiEf_42.js";const E={class:"canvas-container"},B={__name:"ExcelTest",setup(O){const l=d(null),i=d([]),r=d(""),u=t=>{const e=l.value.getContext("2d");if(e.clearRect(0,0,l.value.width,l.value.height),!t)return;const a=50,n=100,o=100;e.font="20px Arial",e.fillStyle="black",e.fillText("Code",a,n),e.fillText("Name",a+200,n),e.fillText("Rate",a+400,n),e.fillText("Image",a+600,n),e.fillText(t.code,a,n+o),e.fillText(t.name,a+200,n+o),e.fillText(t.rate,a+400,n+o);const c=new Image;c.src=t.image_path,c.onload=()=>{e.drawImage(c,a+600,n+o-30,100,100)}},f=()=>{const t=r.value.trim().toLowerCase(),e=i.value.find(a=>String(a.code).toLowerCase()===t);u(e)};return g(()=>{fetch("/data.xlsx").then(t=>t.arrayBuffer()).then(t=>{const e=h(t,{type:"array"}),a=e.Sheets[e.SheetNames[0]],n=_.sheet_to_json(a,{header:1}),o=n[0],c=o.indexOf("name"),m=o.indexOf("code"),x=o.indexOf("image_path"),p=o.indexOf("rate");i.value=n.slice(1).map(s=>({name:s[c]||"",code:s[m]||"",image_path:s[x]||"",rate:s[p]||""})).filter(s=>s.name&&s.code&&s.image_path&&s.rate)}).catch(t=>console.error("Error loading the Excel file:",t))}),(t,e)=>{const a=k("InputText");return y(),T("div",E,[I("canvas",{ref_key:"canvas",ref:l,class:"canvas",width:"800",height:"1000"},null,512),C(a,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=n=>r.value=n),placeholder:"Enter product code",class:"product-input",onInput:f},null,8,["modelValue"])])}}},w=v(B,[["__scopeId","data-v-aac89ec2"]]);export{w as default};
